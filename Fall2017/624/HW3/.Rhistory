plot(p1_s)
p1 = plastics
p1[50] = p1[50] + 500
fit_p1 = decompose(p1, type="multiplicative")
p1_s = seasadj(fit_p1)
plot(p1_s)
p1 = plastics
p1[50] = p1[50] + 500
fit_p1 = decompose(p1, type="multiplicative")
p1_s = seasadj(fit_p1)
plot(p2_s)
p1 = plastics
p2 = plastics
p1 = plastics
p1[1] = p1[1] + 500
fit_p1 = decompose(p1, type="multiplicative")
p1_s = seasadj(fit_p1)
plot(p1_s)
p1 = plastics
p1[5] = p1[5] + 500
fit_p1 = decompose(p1, type="multiplicative")
p1_s = seasadj(fit_p1)
plot(p1_s)
p2 = plastics
p2[30] = p2[30] + 500
fit_p2 = decompose(p1, type="multiplicative")
p2_s = seasadj(fit_p2)
plot(p2_s)
p1 = plastics
p1[5] = p1[5] + 500
fit_p1 = decompose(p1, type="multiplicative")
p1_s = seasadj(fit_p1)
plot(p1_s)
p2 = plastics
p2[30] = p2[30] + 500
fit_p2 = decompose(p1, type="multiplicative")
p2_s = seasadj(fit_p2)
plot(p2_s)
p2 = plastics
p2[30] = p2[30] + 500
fit_p2 = decompose(p2, type="multiplicative")
p2_s = seasadj(fit_p2)
plot(p2_s)
p1 = plastics
p1[5] = p1[5] + 500
fit_p1 = decompose(p1, type="multiplicative")
p1_s = seasadj(fit_p1)
plot(p1_s)
p2 = plastics
p2[30] = p2[30] + 500
fit_p2 = decompose(p2, type="multiplicative")
p2_s = seasadj(fit_p2)
plot(p2_s)
p1 = plastics
p1[50] = p1[50] + 500
fit_p1 = decompose(p1, type="multiplicative")
p1_s = seasadj(fit_p1)
plot(p1_s)
p2 = plastics
p2[30] = p2[30] + 500
fit_p2 = decompose(p2, type="multiplicative")
p2_s = seasadj(fit_p2)
plot(p2_s)
fcast <- forecast(fit, method="naive")
plot(fcast, ylab="New orders index")
foccast = stlf(plastics, method="naive")
plot(forcast)
forcast = stlf(plastics, method="naive")
plot(forcast)
fit <- stl(plastics, t.window=15, s.window="periodic", robust=TRUE)
eeadj <- seasadj(fit)
plot(naive(eeadj), xlab="New orders index",
main="Naive forecasts of seasonally adjusted data")
fcast <- forecast(fit, method="naive")
plot(fcast, ylab="New orders index")
fit <- stl(plastics, t.window=15, s.window="periodic", robust=TRUE)
eeadj <- seasadj(fit)
plot(naive(eeadj),
main="Naive forecasts of seasonally adjusted data")
fcast <- forecast(fit, method="naive")
plot(fcast, ylab="New orders index")
books
plot(books)
plot(ukcars)
plot(books)
ses(books, alpha=0.2, initial="simple", h=3)
ses(books$Paperback, alpha=0.2, initial="simple", h=3)
ses(books alpha=0.2, initial="simple", h=3)
ses(books, alpha=0.2, initial="simple", h=3)
ses(books, alpha=0.2, initial="simple", h=5)
ses(books, alpha=0.2, initial="simple", h=3)
?fitted()
fit1 = ses(books, alpha=0.2, initial="simple", h=3)
fit2 = ses(books, alpha=0.5, initial="simple", h=3)
fit3 = ses(books, alpha=0.7, initial="simple", h=3)
fitted(fit1)
fit1
plot(fit1)
lines(fitted(fit1))
paperback = books[,1]
books
paperback
fit1 = ses(paperback, alpha=0.2, initial="simple", h=3)
fit2 = ses(paperback, alpha=0.5, initial="simple", h=3)
fit3 = ses(paperback, alpha=0.7, initial="simple", h=3)
plot(paperback)
plot(fit1)
plot(fit2)
plot(fit3)
fit1
fit2
fit3
fit4 = ses(paperback, initial="simple", h=3)
fit4
str(fit4)
fit4$model
fit4$mean
fit4$x
fit1-paperback
fit1
fitted(fits1)
fitted(fit1)
papeback - fitted(fit1)
papeback-fitted(fit1)
paperback = books[,1]
paperback-fitted(fit1)
(paperback-fitted(fit1) )^2
sum((paperback-fitted(fit1) )^2)
sum((paperback-fitted(fit1) )^2)
sum((paperback-fitted(fit2) )^2)
sum((paperback-fitted(fit3) )^2)
sum((paperback-fitted(fit4) )^2)
fit1 = ses(paperback, alpha=0.2, initial="simple", h=3)
fit2 = ses(paperback, alpha=0.5, initial="simple", h=3)
fit3 = ses(paperback, alpha=0.7, initial="simple", h=3)
fit4 = ses(paperback, initial="simple", h=3)
fit5 = ses(paperback, alpha=0.1, initial="simple", h=3)
fit6 = ses(paperback, alpha=0.9, initial="simple", h=3)
sum((paperback-fitted(fit1) )^2)
sum((paperback-fitted(fit2) )^2)
sum((paperback-fitted(fit3) )^2)
sum((paperback-fitted(fit4) )^2)
sum((paperback-fitted(fit5) )^2)
sum((paperback-fitted(fit6) )^2)
fit4$model
a = c(0.2, 0.5, 0.7 0.2125, 0.1, 0.9)
s = c(sum((paperback-fitted(fit1) )^2), sum((paperback-fitted(fit2) )^2), sum((paperback-fitted(fit3) )^2), sum((paperback-fitted(fit4) )^2), sum((paperback-fitted(fit5) )^2), sum((paperback-fitted(fit6) )^2))
a = c(0.2, 0.5, 0.7, 0.2125, 0.1, 0.9)
s = c(sum((paperback-fitted(fit1) )^2), sum((paperback-fitted(fit2) )^2), sum((paperback-fitted(fit3) )^2), sum((paperback-fitted(fit4) )^2), sum((paperback-fitted(fit5) )^2), sum((paperback-fitted(fit6) )^2))
sum
sum((paperback-fitted(fit1) )^2)
sum((paperback-fitted(fit2) )^2)
sum((paperback-fitted(fit3) )^2)
sum((paperback-fitted(fit4) )^2)
sum((paperback-fitted(fit5) )^2)
sum((paperback-fitted(fit6) )^2)
a = c(0.2, 0.5, 0.7, 0.2125, 0.1, 0.9)
s = c(36329.34, 41383.7, 48773.56, 36313.98, 37785.2, 58769.45)
plot(a,s)
fit1 = ses(paperback, alpha=0.2, initial="simple", h=3)
fit2 = ses(paperback, alpha=0.5, initial="simple", h=3)
fit3 = ses(paperback, alpha=0.7, initial="simple", h=3)
#fit4 = ses(paperback, initial="simple", h=3)
fit5 = ses(paperback, alpha=0.1, initial="simple", h=3)
fit6 = ses(paperback, alpha=0.9, initial="simple", h=3)
sum((paperback-fitted(fit1) )^2)
sum((paperback-fitted(fit2) )^2)
sum((paperback-fitted(fit3) )^2)
#sum((paperback-fitted(fit4) )^2)
sum((paperback-fitted(fit5) )^2)
sum((paperback-fitted(fit6) )^2)
a = c(0.2, 0.5, 0.7, 0.2125, 0.1, 0.9)
s = c(36329.34, 41383.7, 48773.56, 36313.98, 37785.2, 58769.45)
plot(a,s)
a = c(0.2, 0.5, 0.7, 0.1, 0.9)
s = c(36329.34, 41383.7, 48773.56, 37785.2, 58769.45)
plot(a,s)
fit_o = ses(paperback, initial="optimal", h=3)
fit_o
fit4
fit_o$model
sum((paperback-fitted(fit_o) )^2)
?ses
hardcover = books[,2
]
hardcover
books
fith1 = ses(hardcover, alpha=0.2, initial="simple", h=3)
fith2 = ses(hardcover, alpha=0.5, initial="simple", h=3)
fith3 = ses(hardcover, alpha=0.7, initial="simple", h=3)
fith5 = ses(hardcover, alpha=0.1, initial="simple", h=3)
fith6 = ses(hardcover, alpha=0.9, initial="simple", h=3)
sum((hardcover-fitted(fith1) )^2)
sum((hardcover-fitted(fith2) )^2)
sum((hardcover-fitted(fith3) )^2)
sum((hardcover-fitted(fith5) )^2)
sum((hardcover-fitted(fith6) )^2)
a = c(0.2, 0.5, 0.7, 0.1, 0.9)
s = c(33148.16, 31702.6, 34993.95, 45714.82, 41209.53)
plot(a,s)
fith4 = ses(hardcover, initial="simple", h=3)
sum((hardcover-fitted(fith4) )^2)
fith4$model
fit_o = ses(paperback, initial="optimal", h=3)
sum((paperback-fitted(fit_o) )^2)
fit_o = ses(paperback, initial="optimal", h=3)
fit_o
plot(books)
fit1
fit2
fit3
fit4
fit5
fit6
f = c(209.38, 223.31, 231.74, 210.15, 200.70, 241.39)
plot(a,f, ylab="Forcast", xlab="Alpha")
f = c(209.38, 223.31, 231.74, 200.70, 241.39)
plot(a,f, ylab="Forcast", xlab="Alpha")
plot(a,s,  type= "o", ylab="SSE", xlab="Alpha")
plot(a,f,  type= "o", ylab="Forcast", xlab="Alpha")
plot(a,s, ylab="SSE", xlab="Alpha")
plot(a,f, ylab="Forcast", xlab="Alpha")
plot(a,s, ylab="SSE", xlab="Alpha", main = "SSE with various alphas")
plot(a,f, ylab="Forcast", xlab="Alpha", main = "SES forcast changes as alpha is changed")
fit4 = ses(paperback, initial="simple", h=3)
sum((paperback-fitted(fit4) )^2)
fit4$model
fit_o = ses(paperback, initial="optimal", h=3)
hardcover = books[,2]
fith1 = ses(hardcover, alpha=0.2, initial="simple", h=3)
fith2 = ses(hardcover, alpha=0.5, initial="simple", h=3)
fith3 = ses(hardcover, alpha=0.7, initial="simple", h=3)
fith5 = ses(hardcover, alpha=0.1, initial="simple", h=3)
fith6 = ses(hardcover, alpha=0.9, initial="simple", h=3)
sum((hardcover-fitted(fith1) )^2)
sum((hardcover-fitted(fith2) )^2)
sum((hardcover-fitted(fith3) )^2)
sum((hardcover-fitted(fith5) )^2)
sum((hardcover-fitted(fith6) )^2)
a = c(0.2, 0.5, 0.7, 0.1, 0.9)
s = c(33148.16, 31702.6, 34993.95, 45714.82, 41209.53)
plot(a,s)
fith4 = ses(hardcover, initial="simple", h=3)
sum((hardcover-fitted(fith4) )^2)
fith4$model
#(alpha = 0.3473)
fit_o = ses(paperback, initial="optimal", h=3)
fit_o
fith1
fith2
fith3
fith5
fith6
sum((hardcover-fitted(fith1) )^2)
sum((hardcover-fitted(fith2) )^2)
sum((hardcover-fitted(fith3) )^2)
sum((hardcover-fitted(fith5) )^2)
sum((hardcover-fitted(fith6) )^2)
a = c(0.2, 0.5, 0.7, 0.1, 0.9)
s = c(33148.16, 31702.6, 34993.95, 45714.82, 41209.53)
f = c(232.01, 245.73, 250.80, 217.06, 255.64)
plot(a,s)
plot(a,f)
fith4 = ses(hardcover, initial="simple", h=3)
fith4$model
sum((hardcover-fitted(fith4) )^2)
fit_o = ses(paperback, initial="optimal", h=3)
fit_o
fith4
ses(paperback, initial="optimal", h=3)
ses(paperback, initial="optimal", h=4)
ses(hardcover, initial="simple", h=3)
plot(fith4)
plot(fit_o)
fito
fit_o
simmary(fit_o)
summary(fit_o)
plot(ukcars)
fit <- decompose(ukcars, type="multiplicative")
plot(fit)
season = seasadj(fit)
plot(season)
?ses
fit_o
describe(fit_o)
discribe(fit_o)
summary(fit_o)
summary(fit4)
summary(fit_o)
summary(fith_o)
summary(fith4)
fit_o$level
fit_o$residuals
plot(ukcars)
fit <- decompose(ukcars, type="multiplicative")
plot(fit)
fit <- stl(ukcars, t.window=15, s.window="periodic", robust=TRUE)
plot(fit)
season = seasadj(fit)
plot(season)
ukcars
damped <- holt(season,exponential=TRUE,damped=TRUE)
fit(damped)
damped <- holt(season,exponential=TRUE,damped=TRUE)
plot(damped)
damped <- holt(season,exponential=TRUE, h=8, damped=TRUE)
plot(damped)
damped
damped <- holt(season, h=8, damped=TRUE)
plot(damped)
fcast <- forecast(damped, method="naive")
plot(fcast)
plot(damped)
plot(fcast)
fit <- stl(ukcars, t.window=15, s.window="periodic", robust=TRUE)
season = seasadj(fit)
damped <- holt(season, h=8, damped=TRUE)
plot(damped)
fcast <- forecast(damped, method="naive")
plot(fcast)
damped
fcast
plot(fit)
plot(fcast)
plot(season)
plot(damped)
plot(fcast)
plot(fit)
?stl()
fit <- stl(ukcars, s.window=15, s.window="periodic", robust=TRUE)
plot(fit)
season = seasadj(fit)
plot(season)
damped <- holt(season, h=8, damped=TRUE)
plot(damped)
fcast <- forecast(damped, method="naive")
plot(fcast)
?stlf
?stl()
plot(fit)
plot(season)
plot(ukcars)
plot(season)
plot(naive(fcast))
plot(naive(season))
plot(damped)
plot(naive(season))
plot(fcast)
fcast <- forecast(season, method="naive")
plot(fcast)
fcast <- forecast(fit, method="naive")
plot(fcast)
fit <- stl(ukcars, t.window=15, s.window="periodic", robust=TRUE)
fit
fit["seasonal"]
fit[,"seasonal"]
fit[, "seasonal"]
fit$time.series
fit$time.series[, "seasonal"]
fit$time.series
reseason = damped+fit$time.series[, "seasonal"]
damped
damped$series
damped$series["season"]
damped$series
damped$fitted
reseason = damped$fitted+fit$time.series[, "seasonal"]
plot(reseason)
ukcars
damped
fit$mean
damped$mean
damped
rep(damped$time.series[110:113,"seasonal"],2)
rep(fit$time.series[110:113,"seasonal"],2)
rep(fit$time.series)
?seasadj
season
?rep
?decomposed()
?rep()
fit$time.series
fit$time.series["seasonal"]
fit$time.series[, "seasonal"]
fit$time.series["seasonal",2]
fit$time.series[110:113,"seasonal"]
fit$time.series[110:113,"seasonal",2]
fit$time.series[110:113,"seasonal"]
fit$mean
damped$mean
damped
reseason = damped+fit$time.series[, "seasonal"]
fit$time.series[110:113,"seasonal"]
reseason = fit$time.series[110:113,"seasonal"]
damped$mean + reseason
damped
damped$mean
damped$mean + reseason
reasesoned_forcast = damped$mean + reseason
plot(ukcars)
plot(reasesoned_forcast)
reasesoned_forcast
reseason
plot(ukcars)
lines(reasesoned_forcast, col="red")
lines(reasesoned_forcast, col="yellow")
lines(reasesoned_forcast, col="green")
lines(reasesoned_forcast, col="blue")
holt_linear = holt(season, h=8)
plot(holt_linear)
holet_reseason = holt_linear$mean + reseason
holet_reseason$model
holt_reseason = holt_linear$mean + reseason
holt_reseason
summary(holt_reseason)
holt_linear$model
summary(holt_linear)
ets(season)
fit_ets = ets(season)
summary(fit_ets)
?predict()
predict(fit_ets)
predict(holt_linear)
plot(ukcars)
forcast(damped)
damped
forcast(damped)
summary(reasesoned_forcast)
summary(samped)
summary(damped)
damped
holt_linear
fit_ets
fit_ets$m
fit_ets$series
fit_ets
fit_ets$mse
fit_ets$fit
fit_ets$fitted
fit_ets$fit
fit_ets$fitted
holt_linear$fitted
plot(holt_linear$fitted)
line(fit_ets, col="blue")
lines(fit_ets, col="blue")
lines(fit_ets$fitted, col="blue")
damped
lines(damped, col="yellow")
lines(damped$fitted, col="yellow")
damped$fitted
damped
damped$mean
plot(damped$fitted)
lines(holt_linear$fitted, col="blue")
plot(damped$mean)
lines(holt_linear$mean, col="blue")
holt_linear$mean
fit_ets$mean
fit_ets$m
forcast(fit_ets)
forcast(fit_ets, h=8)
forecast(fit_ets, h=8)
damped
holt_linear$mean
plot(holt_linear$mean)
lines(damped, col="blue")
lines(damped$mean, col="blue")
damped$mean
lines(forcast(fit_ets, h=8), col="yellow")
lines(forcast(fit_ets, h=8), col="red")
lines(forecast(fit_ets, h=8), col="red")
plot(forecast(fit_ets, h=8), col="red")
fit_ets
fit_ets$m
fit_ets$components
fit_ets$x
forecast(fit_ets, h=8)
forecast(fit_ets, h=8)$mean
plot(forecast(fit_ets, h=8)$mean)
lines(damped$mean, col="blue")
lines(holt_linear$mean, col="red")
fit_ets
BK = read.csv("/c/data/608/BORO_zip_files_csv/BK.csv", header = TRUE)
BK = read.csv("c/data/608/BORO_zip_files_csv/BK.csv", header = TRUE)
BK = read.csv("C:/data/608/BORO_zip_files_csv/BK.csv", header = TRUE)
head(BK)
BX = read.csv("C:/data/608/BORO_zip_files_csv/BX.csv", header = TRUE)
MN = read.csv("C:/data/608/BORO_zip_files_csv/MN.csv", header = TRUE)
QN = read.csv("C:/data/608/BORO_zip_files_csv/QN.csv", header = TRUE)
SI = read.csv("C:/data/608/BORO_zip_files_csv/SI.csv", header = TRUE)
data = cbind(BK,BX,MN,QN,SI)
data = merge(BK,BX,MN,QN,SI)
data = merge(BK,BX)
data = rbind(BK,BX,MN,QN,SI)
ncol(BK)
nrows(BK)
nrow(BK)
nrow(BK)+nrow(BX)
nrow(BK)+nrow(BX)+nrow(MN)+nrow(QN)+nrow(SI) == nrow(data)
write.csv(data, file = "boro_complete.csv")
getwd()
install.packages(bigwis)
install.packages("bigwis")
sys.which("g++")
Sys.which("g++")
devtools:::install_github("hadley/bigvis")
devtools:::install_github("hadley/bigvis")
Sys.which( "g++" )
install.packages("rcpp")
install.packages("Rcpp")
Sys.which('g++')
